<pre>
<?php
ob_start();
$str1 = '3082044f30820237a00302010202020a03300d06092a864886f70d01010d0500304d311630140603550403130d4c6f63616c20526f6f742043413111300f060355040a13086d792c204f72672e3120301e060355040b13176d797320547275737420576f726b2053656375726974793022180f32303233303531343039313434365a180f32303333303531343039313434365a30733120301e060355040b13176d797320547275737420576f726b20536563757269747931273025060355040b131e5465726d73206f6620757365206174202e6e65742f7270612028632930393111300f060355040a13086d792c204f72672e311330110603550403130a7463706466207465737430819f300d06092a864886f70d010101050003818d0030818902818100d03ec4d52385a5fad3fa16e8430ac9ad37f77d6c6be61d297773ff6bfbbcde405d0d1d69548a1595f45092bdf1581577e6a16f20694dbbfeb1c4387f34ac307ff9702e8cd168b11e16329b0835cc46f6bd6306c358873d3c98293fbec893506752daed5e64dddce7bb56f57939c6b2059a8562666da0a663fbcfc0980b93bcd70203010001a3819230818f301d0603551d0e0416041410caf53e276581aad9b73888672e681338db2a0a301f0603551d23041830168014167f60ad6aae5a667599212731eb3d0a2b80c5b8303f06082b0601050507010104333031302f06082b060105050730028623687474703a2f2f6c6f63616c686f73742f63612f4c6f63616c526f6f7443412e637274300c0603551d130101ff04023000300d06092a864886f70d01010d050003820201004a69d0600d22763d3e2ee82a124d68ce2c7d3ec3b889b470a6eec774856a43447808372c712f7eafae72358ec16bd0ba308ead0deb512779589a26b5b134481c930af023f1783805e0af84c063dd5ff04ca1877b0f18f8aa018eecedbb0c59dc5d341962810b1cd4fb0a8f1cb71f79672e98f2d992c1349b3d21ffbba8019cb510ecabbd42b646726e53618dfbd339b6b73289bc1c099195e1dfd344e5c7785b7dd2f0964bc10bf9835a5523bd24d594c356366d95163979d3e913cee9072cf2c0a7fc0eab4cadf2fd2575d672fef4072c2abd890584d6c108c3c84026f0b8e249d7b7168469572ba5455d55d81d7800bbf4848509a682163369ce6e2f9d17b56b5c40e7ffb45355def18f08c16dfc89980adb84eb4a497e227c3811d6b410055d5822003fcd5171b626011f7a63e0b452bb39b86b122acf8a3607ff7910c8c5d712cb934e09f6bb63d1249c908c614283bcf48db3f6cecb2159626452a0a4a048be5ac0736ebefc9fb1c58637e87c259204d8d5a1d48ee25552a5eda77a59a79691363a8167551ccb47f431e73c9f93687731f54602329448c388db127b3d83967c4721ab7269ae0f932a2fcd38d2e3b2b7bbd7415728ca3e9716bfc64321631c7a941c508e7c7b35c70a4c282cfce6f90e6d6e553523b6e332abd9796e78f8bad1a94ab8f87b0f7b8b4fed5495ed804c2c1c82cca910f8ea5b85368d15009b';
$str2 = '30820237a00302010202020a03300d06092a864886f70d01010d0500304d311630140603550403130d4c6f63616c20526f6f742043413111300f060355040a13086d792c204f72672e3120301e060355040b13176d797320547275737420576f726b2053656375726974793022180f32303233303531343039313434365a180f32303333303531343039313434365a30733120301e060355040b13176d797320547275737420576f726b20536563757269747931273025060355040b131e5465726d73206f6620757365206174202e6e65742f7270612028632930393111300f060355040a13086d792c204f72672e311330110603550403130a7463706466207465737430819f300d06092a864886f70d010101050003818d0030818902818100d03ec4d52385a5fad3fa16e8430ac9ad37f77d6c6be61d297773ff6bfbbcde405d0d1d69548a1595f45092bdf1581577e6a16f20694dbbfeb1c4387f34ac307ff9702e8cd168b11e16329b0835cc46f6bd6306c358873d3c98293fbec893506752daed5e64dddce7bb56f57939c6b2059a8562666da0a663fbcfc0980b93bcd70203010001a3819230818f301d0603551d0e0416041410caf53e276581aad9b73888672e681338db2a0a301f0603551d23041830168014167f60ad6aae5a667599212731eb3d0a2b80c5b8303f06082b0601050507010104333031302f06082b060105050730028623687474703a2f2f6c6f63616c686f73742f63612f4c6f63616c526f6f7443412e637274300c0603551d130101ff04023000300d06092a864886f70d01010d050003820201004a69d0600d22763d3e2ee82a124d68ce2c7d3ec3b889b470a6eec774856a43447808372c712f7eafae72358ec16bd0ba308ead0deb512779589a26b5b134481c930af023f1783805e0af84c063dd5ff04ca1877b0f18f8aa018eecedbb0c59dc5d341962810b1cd4fb0a8f1cb71f79672e98f2d992c1349b3d21ffbba8019cb510ecabbd42b646726e53618dfbd339b6b73289bc1c099195e1dfd344e5c7785b7dd2f0964bc10bf9835a5523bd24d594c356366d95163979d3e913cee9072cf2c0a7fc0eab4cadf2fd2575d672fef4072c2abd890584d6c108c3c84026f0b8e249d7b7168469572ba5455d55d81d7800bbf4848509a682163369ce6e2f9d17b56b5c40e7ffb45355def18f08c16dfc89980adb84eb4a497e227c3811d6b410055d5822003fcd5171b626011f7a63e0b452bb39b86b122acf8a3607ff7910c8c5d712cb934e09f6bb63d1249c908c614283bcf48db3f6cecb2159626452a0a4a048be5ac0736ebefc9fb1c58637e87c259204d8d5a1d48ee25552a5eda77a59a79691363a8167551ccb47f431e73c9f93687731f54602329448c388db127b3d83967c4721ab7269ae0f932a2fcd38d2e3b2b7bbd7415728ca3e9716bfc64321631c7a941c508e7c7b35c70a4c282cfce6f90e6d6e553523b6e332abd9796e78f8bad1a94ab8f87b0f7b8b4fed5495ed804c2c1c82cca910f8ea5b85368d15009b';
$str3 = 'a00302010202020a03300d06092a864886f70d01010d0500304d311630140603550403130d4c6f63616c20526f6f742043413111300f060355040a13086d792c204f72672e3120301e060355040b13176d797320547275737420576f726b2053656375726974793022180f32303233303531343039313434365a180f32303333303531343039313434365a30733120301e060355040b13176d797320547275737420576f726b20536563757269747931273025060355040b131e5465726d73206f6620757365206174202e6e65742f7270612028632930393111300f060355040a13086d792c204f72672e311330110603550403130a7463706466207465737430819f300d06092a864886f70d010101050003818d0030818902818100d03ec4d52385a5fad3fa16e8430ac9ad37f77d6c6be61d297773ff6bfbbcde405d0d1d69548a1595f45092bdf1581577e6a16f20694dbbfeb1c4387f34ac307ff9702e8cd168b11e16329b0835cc46f6bd6306c358873d3c98293fbec893506752daed5e64dddce7bb56f57939c6b2059a8562666da0a663fbcfc0980b93bcd70203010001a3819230818f301d0603551d0e0416041410caf53e276581aad9b73888672e681338db2a0a301f0603551d23041830168014167f60ad6aae5a667599212731eb3d0a2b80c5b8303f06082b0601050507010104333031302f06082b060105050730028623687474703a2f2f6c6f63616c686f73742f63612f4c6f63616c526f6f7443412e637274300c0603551d130101ff04023000';


// 02:47 20/05/2023
// 256 820100
// 255 81ff
// 128 8180
// 127 7f
set_time_limit(3);

function asn1_parse($hex) {
	  if(@strlen($hex)%2!=0 || !@ctype_xdigit($hex)) {
		  return false;
	  }
	  $stop = false;
	  while($stop == false) {
      $asn1_Id = substr($hex, 0, 2);
      $header = substr($hex, 2, 2);
      $tlv_tagLength = hexdec(substr($hex, 2, 2));
      if($tlv_tagLength > 127) {
        $tlv_lengthLength = $tlv_tagLength-128;
        $tlv_valueLength = substr($hex, 4, ($tlv_lengthLength*2));
      } else {
        $tlv_lengthLength = 0;
        $tlv_valueLength = substr($hex, 2, 2+($tlv_lengthLength*2));
      }
      $tlv_valueLength = hexdec($tlv_valueLength);
      
      $totalTlLength = 2+2+($tlv_lengthLength*2);
      $reduction = 2+2+($tlv_lengthLength*2)+($tlv_valueLength*2);
      $tlv_value = substr($hex, $totalTlLength, $tlv_valueLength*2);
      $remain = substr($hex, $totalTlLength+($tlv_valueLength*2));
      $newhexdump = substr($hex, 0, $totalTlLength+($tlv_valueLength*2));
      
      $result[] = array(
                        //'tlv_tagLength'=>strlen(dechex($tlv_tagLength))%2==0?dechex($tlv_tagLength):'0'.dechex($tlv_tagLength),
                        //'tlv_lengthLength'=>$tlv_lengthLength,
                        //'tlv_valueLength'=>$tlv_valueLength,
                        //'reduction'=>$reduction,
                        //'hex'=>$hex,
                        'newhexdump'=>$newhexdump,
                        'typ'=>$asn1_Id,
                        'tlv_value'=>$tlv_value,
                        'remain'=>$remain
                        );

      if($remain == '') { // if remains string was empty & contents also empty, function return FALSE
        $stop = true;
        //return false;
      } else {
        $hex = $remain;
      }
	  }
	  return $result;
}


//$f = file_get_contents('t.cer');
$f = $str1;
$f = asn1_parse($f);
echo "==============================print_r1======================================================\n";
print_r($f);
echo "==============================eprint_r1======================================================\n";
$f = asn1_parse($f[0]['tlv_value']);
echo "==============================print_r1======================================================\n";
print_r($f);
echo "==============================eprint_r1======================================================\n";
$f = asn1_parse($str2);
echo "==============================print_r2======================================================\n";
print_r($f);
echo "==============================eprint_r2======================================================\n";
$f = asn1_parse($str3);
echo "==============================print_r3======================================================\n";
//echo "$str3\n";
print_r($f);
echo "==============================eprint_r3======================================================\n";


$out = ob_get_contents();
ob_end_clean();
$ar = explode("\n", $out);
$vis = '';
$i=count($ar);
$iLength=strlen($i);
foreach($ar as $arv) {
  $vis .= '<span style="background-color:grey"><b>'.str_pad($i, $iLength, " ")."</b></span> $arv\n";
  $i--;
}
echo $vis;

?>